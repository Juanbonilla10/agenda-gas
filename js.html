<script>
        
    function crearTableContactos(){

        let tabla = document.getElementById('tablaContactos');
        if(tabla) tabla.remove();

        google.script.run
        .withSuccessHandler(crearTablaContactosCorrectamente)
        .withFailureHandler(crearTablaContactosError)
        .obtenerContactos();

    }


    function crearTablaContactosCorrectamente(obj)
            {
                
                tabla = document.createElement('table');
                tabla.id = 'tablaContactos';
                let tablaHeader = document.createElement('thead');
                let tablaBody = document.createElement('tbody');
                Array.from(obj).forEach((filaActual,i) =>{
                    let fila = document.createElement('tr');
                    filaActual.forEach(celdaActual =>{
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if(i==0){
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }else{
                        tablaBody.appendChild(fila);
                    }
                    
                });

                tablaHeader.classList.add('table-dark')
                tabla.appendChild(tablaBody);
                tabla.classList.add('table','table-striped','border','border-4','border-dark');

                document.getElementById('divContactos').appendChild(tabla);

                //mostrar notificacion de ok
                crearNotificacionOK('Contactos obtenidos correctamente','todo en orden')
            }


    function crearTablaContactosError(){
        //mostrar notificacion de error
        crearNotificacionError('No se han podido obtener los contactos','error')
    }
    function crearNotificacion(mensaje,titulo)
    {
        document.getElementById('textoNotificacion').textContent = mensaje;
        document.getElementById('tituloNotificacion').textContent = titulo;
        let elementoNotificacion = document.getElementById('notificacion');
        bootstrap.Toast.getOrCreateInstance(elementoNotificacion).show();
    }

    function crearNotificacionOK(mensaje,titulo)
    {
        crearNotificacion(mensaje,titulo);
        crearIconoNotificacionOK();
        crearColorNotificacion('--color-verde-oscuro');
    }
    function crearNotificacionError(mensaje,titulo)
    {
        crearNotificacion(mensaje,titulo);
        crearIconoNotificacionError();
        crearColorNotificacion('--color-rojo-oscuro');
    }

    function crearNotificacionAdvertencia(mensaje,titulo)
    {
        crearNotificacion(mensaje,titulo);
        crearIconoNotificacionAdvertencia();
        crearColorNotificacion('--color-amarillo-oscuro');
    }
    function crearIconoNotificacionOK()
    {
        document.getElementById('iconoNotificacion').className = '';
        document.getElementById('iconoNotificacion').classList.add('bi','bi-check2-square'); 
    }
    function crearIconoNotificacionError()
    {
        document.getElementById('iconoNotificacion').className = '';
        document.getElementById('iconoNotificacion').classList.add('bi','bi-bug'); 
    }
    function crearIconoNotificacionAdvertencia()
    {
        document.getElementById('iconoNotificacion').className = '';
        document.getElementById('iconoNotificacion').classList.add('bi','bi-exclamation-square'); 
    }
    function crearColorNotificacion(color)
    {
        let elementoNotificacion = document.getElementById('notificacion');
        elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(color);
    }

</script>